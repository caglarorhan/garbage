<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cam test 10</title>
</head>
<body>
<label for="barcodeContainingImage">Take a barcode/qrcode picture:</label>

<input type="file"
       id="barcodeContainingImage" name="barcodeContainingImage"
       accept="image/png, image/jpeg" capture="environment">

<span id="theBarcodeValue">BARCODE DATA PLACE</span>

<script>
    const barcodeDetector = new BarcodeDetector({formats: ['code_39', 'codabar', 'ean_13']});
    const barcodeContainingImage = document.getElementById('barcodeContainingImage');
    const theBarcodeValue = document.getElementById('theBarcodeValue');

    barcodeContainingImage.addEventListener('change', function () {
        const fr = new FileReader()
        const file = barcodeContainingImage.files[0]
        fr.readAsArrayBuffer(file)
        fr.onload = function() {
            const blob = new Blob([fr.result])

        barcodeDetector.detect(blob).then(function(barcodes) {
            if (barcodes.length > 0) {
                theBarcodeValue.innerText = barcodes[0].rawValue;
            }
        })
        }
    });


</script>
</body>
</html>
