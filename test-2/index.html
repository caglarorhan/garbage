<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cam test 8</title>
</head>
<body>
<label for="barcodeContainingImage">Take a barcode/qrcode picture:</label>

<input type="file"
       id="barcodeContainingImage" name="barcodeContainingImage"
       accept="image/png, image/jpeg" capture="environment">

<span id="theBarcodeValue">BARCODE DATA PLACE</span>



<script>
    window.addEventListener('load',()=>{
        let barcodeContainingImage = document.getElementById('barcodeContainingImage');
        barcodeContainingImage.addEventListener('change',()=>{
            alert('OK')
            let file = barcodeContainingImage.files[0];
            document.getElementById('theBarcodeValue').innerHTML='File is ready...';
            bD.detect(file);

        });
    });

    const bD = {
        barcodeFormats: [
            "aztec",
            "code_128",
            "code_39",
            "code_93",
            "codabar",
            "data_matrix",
            "ean_13",
            "ean_8",
            "itf",
            "pdf417",
            "qr_code",
            "unknown",
            "upc_a",
            "upc_e"],
        barcodeContainingImage: document.getElementById('barcodeContainingImage'),
        barcodeContainer: document.getElementById("theBarcodeValue"),
        detect: async (file) => {
            if(!('BarcodeDetector' in window)){alert('barcodedetector desteklenmiyor'); return false;}
            document.getElementById('theBarcodeValue').innerHTML="Detection started";
            let barcodeDetector = new BarcodeDetector();
            alert('barcodedetector created');
            alert(file)
            barcodeDetector.detect(file)
                .then(detectedCodes => {
                    for (const barcode of detectedCodes) {
                        alert(' Barcode ${barcode.rawValue}' +
                            ' @ (${barcode.boundingBox.x}, ${barcode.boundingBox.y}) with size' +
                            ' ${barcode.boundingBox.width}x${barcode.boundingBox.height}');
                    }
                }).catch(() => {
                alert("Barcode Detection failed, boo.");
            })
        }
    }




</script>
</body>
</html>
