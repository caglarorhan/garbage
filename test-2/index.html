<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cam test</title>
</head>
<body>
<label for="barcodeContainingImage">Take a barcode/qrcode picture:</label>

<input type="file"
       id="barcodeContainingImage" name="barcodeContainingImage"
       accept="image/png, image/jpeg" capture="capture">

<span id="theBarcodeValue"></span>



<script>
    const bD = {};
            bD.trigger=()=>{
                let imageEl = document.getElementById('barcodeContainingImage').value;
                            bD.detect(imageEl)  ;
            }
            bD.writeBarcodeData = (data)=>{
                document.getElementById("theBarcodeValue").innerHTML+=data;
            }
            bD.detect = (imageEl)=>{
                // check compatibility
                if (!('BarcodeDetector' in window)) {
                    console.log('Barcode Detector is not supported by this browser.');
                } else {
                    console.log('Barcode Detector supported!');
                    // create new detector
                    var barcodeDetector = new BarcodeDetector({formats: ['code_39', 'codabar', 'ean_13']});
                }

                // check supported types
                BarcodeDetector.getSupportedFormats()
                    .then(supportedFormats => {
                        supportedFormats.forEach(format => console.log(format));
                    });


                barcodeDetector.detect(imageEl)
                    .then(barcodes => {
                        barcodes.forEach(barcode => bD.writeBarcodeData(barcode.rawData));
                    })
                    .catch(err => {
                        console.log(err);
                    })
            }



</script>
</body>
</html>
